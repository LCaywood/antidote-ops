version: '2.0'
antidoteops.tweet_new_content:
    description: Tweet new content
    input:
        - title
        - featuredimage
        - link

    # TODO add account logic

    type: direct

    tasks:

        first_tweet:
            action: twitter.update_status
            input:
                status: "[New Post] <% $.title %> <% $.link %>"
                media: ["<% $.featuredimage %>"]
            on-success:
                - first_sleep

        first_sleep:
            action: core.pause
            timeout: 87000
            input:
                timeout: 87000
                max_pause: 86400
            on-success:
                - second_tweet

        second_tweet:
            action: twitter.update_status
            input:
                status: "♻ Post: <% $.title %> <% $.link %>"
                media: ["<% $.featuredimage %>"]
            on-success:
                - second_sleep

        second_sleep:
            action: core.pause
            timeout: 87000
            input:
                timeout: 87000
                max_pause: 86400
            on-success:
                - third_tweet

        third_tweet:
            action: twitter.update_status
            input:
                status: "♻♻ Post: <% $.title %> <% $.link %>"
                media: ["<% $.featuredimage %>"]
